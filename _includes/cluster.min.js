var po=org.polymaps,map=po.map().container(document.getElementById("map").appendChild(po.svg("svg"))).center({lat:37.787,lon:-122.228}).zoom(14).zoomRange([12,16]).add(po.interact());map.add(po.image().url(po.url("http://{S}tile.cloudmade.com/1a1b06b230af4efdbb989ea99e9841af/20760/256/{Z}/{X}/{Y}.png").hosts(["a.","b.","c.",""])));map.add(po.geoJson().url(crimespotting("http://oakland.crimespotting.org/crime-data?count=1000&format=json&bbox={B}&dstart=2010-04-01&dend=2010-05-01")).on("load",load).clip(false).zoom(14));
map.add(po.compass().pan("none"));
function load(a){for(var c=a.tile.cluster||(a.tile.cluster=kmeans().iterations(16).size(64)),b=0;b<a.features.length;b++)c.add(a.features[b].data.geometry.coordinates);a=a.tile;for(var d=a.element;d.lastChild;)d.removeChild(d.lastChild);c=c.means();c.sort(function(g,h){return h.size-g.size});for(b=0;b<c.length;b++){var e=c[b],f=d.appendChild(po.svg("circle"));f.setAttribute("cx",e.x);f.setAttribute("cy",e.y);f.setAttribute("r",Math.pow(2,a.zoom-11)*Math.sqrt(e.size))}};
