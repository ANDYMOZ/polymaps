var po=org.polymaps,div=document.getElementById("map"),map=po.map().container(div.appendChild(po.svg("svg"))).add(po.interact()).add(po.hash()),script=document.createElement("script");script.setAttribute("type","text/javascript");script.setAttribute("src","http://dev.virtualearth.net/REST/V1/Imagery/Metadata/AerialWithLabels?key=AmT-ZC3HPevQq5IBJ7v8qiDUxrojNaqbW1zBsKF0oMNEs53p7Nk5RlAuAmwSG7bg&jsonp=callback");document.body.appendChild(script);
function callback(c){for(var e=c.resourceSets,d=0;d<e.length;d++)for(var f=c.resourceSets[d].resources,a=0;a<f.length;a++){var b=f[a];map.add(po.image().url(template(b.imageUrl,b.imageUrlSubdomains))).tileSize({x:b.imageWidth,y:b.imageHeight})}document.getElementById("logo").src=c.brandLogoUri;document.getElementById("copy").appendChild(document.createTextNode(c.copyright));map.add(po.compass().pan("none"))}
function template(c,e){var d=e.length,f=~~(Math.random()*d);return function(a){var b;b=a.zoom;for(var h="",g=1;g<=b;g++)h+=(a.row>>b-g&1)<<1|a.column>>b-g&1;b=h;a=Math.abs(f+a.column+a.row+a.zoom)%d;return c.replace("{quadkey}",b).replace("{subdomain}",e[a])}};
