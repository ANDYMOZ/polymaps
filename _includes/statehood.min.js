var po=org.polymaps,quantile=pv.Scale.quantile().quantiles(9).domain(pv.values(states)).range(0,8),format=pv.Format.date("%B %e, %Y"),map=po.map().container(document.getElementById("map").appendChild(po.svg("svg"))).center({lat:40,lon:-95}).zoomRange([3,7]).zoom(4).add(po.interact());map.add(po.image().url(po.url("http://{S}tile.cloudmade.com/1a1b06b230af4efdbb989ea99e9841af/20760/256/{Z}/{X}/{Y}.png").hosts(["a.","b.","c.",""])));
map.add(po.geoJson().url("http://polymaps.appspot.com/state/{Z}/{X}/{Y}.json").on("load",load));map.add(po.compass().pan("none"));map.container().setAttribute("class","Blues");
function load(d){for(var b=0;b<d.features.length;b++){var a=d.features[b],c=states[a.data.id.substring(6)];if(c==undefined)a.element.setAttribute("display","none");else{a.element.setAttribute("class","q"+quantile(c)+"-9");a.element.appendChild(po.svg("title").appendChild(document.createTextNode(a.data.properties.name+": "+format(c).replace(/ [ ]+/," "))).parentNode)}}};
