var po=org.polymaps,population=tsv("population.tsv").key(function(a){return a[1]}).value(function(a){return a[2].replace(/,/g,"")}).map(),internet=tsv("internet.tsv").key(function(a){return a[1]}).value(function(a){return a[2].replace(/,/g,"")}).map(),map=po.map().container(document.getElementById("map").appendChild(po.svg("svg"))).center({lat:40,lon:0}).zoomRange([1,4]).zoom(2).add(po.interact());map.add(po.image().url("http://s3.amazonaws.com/com.modestmaps.bluemarble/{Z}-r{Y}-c{X}.jpg"));
map.add(po.geoJson().url("world.json").tile(false).zoom(3).on("load",load));map.add(po.compass().pan("none"));map.container().setAttribute("class","YlOrRd");function load(a){for(var c=0;c<a.features.length;c++){var e=a.features[c],d=e.data.properties.name,b=internet[d]/population[d];n$(e.element).attr("class",isNaN(b)?null:"q"+~~(b*9)+"-9").add("svg:title").text(d+(isNaN(b)?"":":  "+percent(b)))}}function percent(a){return(a*100).toPrecision(Math.min(2,2-Math.log(a)/Math.LN2))+"%"};
